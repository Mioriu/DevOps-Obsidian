## ![](https://ucarecdn.stepik.net/e7a00e86-8274-417a-a963-e11d7f7e1c63/)

Для начала, можно посмотреть [наше видео про сети](https://www.youtube.com/watch?v=qsKiA35prDs&t=2s) 

Прежде чем настраивать реальные интерфейсы или отлаживать соединения, полезно освежить в памяти, _как вообще ходят данные по сети_. В Linux-администрировании чаще всего говорят о **модели TCP/IP** (иногда «DoD model») — именно она описывает, что происходит с пакетом от приложения до сетевого кабеля.

|Уровень TCP/IP|Примеры протоколов|Что делает|
|---|---|---|
|**4. Прикладной  <br>(Application)**|HTTP, SSH, DNS, SMTP|Работа с содержимым (файлы, письма, веб-страницы). Пользователь видит именно этот уровень.|
|**3. Транспортный  <br>(Transport)**|TCP, UDP|Делит данные на сегменты, нумерует, контролирует доставку (TCP) или отправляет «как есть» (UDP).  <br>Главный идентификатор — _порт_.|
|**2. Сетевой  <br>(Internet)**|IPv4, IPv6, ICMP|Добавляет IP-адрес отправителя и получателя, решает, куда направить пакет дальше.|
|**1. Канальный + Физический  <br>(Link + Physical)**|Ethernet, Wi-Fi, PPP|Преобразует IP-пакет в кадры с MAC-адресами и отправляет по кабелю / радио.|

### Почему 4 уровня, а не 7 как в OSI?

- TCP/IP — практическая модель, созданная инженерами ARPANET; она склеила физический и канальный уровни в один, а самые верхние уровни OSI объединила в Application.
- На практике большинство Linux-утилит (ssh, curl, ping) оперируют именно этими четырьмя слоями.

![](https://ucarecdn.stepik.net/a6a418fb-c44b-4336-921e-a5c1bb8c5755/)

### Ключевые термины

- **IP-адрес** — уникальный адрес узла в сети (пример IPv4: 192.168.1.10). Определяет, _куда_ доставить пакет.
- **MAC-адрес** — аппаратный адрес сетевой карты (пример Ethernet: **08:00:27:6a:4b:2c**). Используется внутри локальной сети для доставки кадров.
- **Порт** — 16-битное число (0–65535), которое идентифицирует конкретное серверное приложение на узле (80 — HTTP, 22 — SSH). Порты существуют только на уровне TCP/UDP.
- **MTU** (_Maximum Transmission Unit_) — максимальный размер кадра, который можно отправить в сети без фрагментации (обычно 1500 байт для Ethernet).

### Жизненный путь пакета TCP

Приложение           (curl http://example.com)
    │
    ▼
TCP-сегмент          (порт источника 55123 → порт назначения 80)
    │
    ▼
IP-пакет             (IP источника 10.0.0.5 → IP назначения 93.184.216.34)
    │
    ▼
Ethernet-кадр        (MAC источника 08:00:27:xx:xx:xx → MAC роутера 34:af:..)
    │
    ▼
Физическая среда     (витая пара / Wi-Fi / оптика)

- На каждом узле кадр принимается сетевой картой, удаляется канальный конверт, читается IP-заголовок и пакет отправляется дальше (или в локальный стек, если адрес получателя — наш).
- Когда пакет доходит до назначения, стек TCP собирает сегменты и передаёт данные приложению.

### ICMP — служебная почта IP

Протокол ICMP (часть сетевого уровня) передаёт сообщения об ошибках и диагностику:

- `ping` — ICMP Echo Request / Echo Reply.
- `traceroute` — использует Time-To-Live exceeded для построения маршрута.

> **ICMP** — это **сетевой уровень**, не прикладной и не транспортный.

### Роутинг: как выбирается путь

- Каждый Linux-хост хранит таблицу маршрутов (`ip route`). В ней указано, куда отправлять пакеты для разных сетей (локально, через шлюз, по умолчанию).
- Если сеть «прямая» — кадр идёт сразу на MAC получателя; если удалённая — сначала к шлюзу (роутеру).

### Полезные сетевые команды (спойлер следующих уроков)

|Команда|Что показывает / делает|
|---|---|
|`ip addr`|IP-адреса интерфейсов|
|`ip link`|физические/виртуальные интерфейсы|
|`ip route`|таблица маршрутов|
|`ping`|доступность узла (ICMP)|
|`ss -tln`|прослушиваемые TCP-порты|
|`traceroute`|цепочку роутеров до цели|

> ### ⚠️ Не путайте
> 
> - Порты существуют **на уровне TCP/UDP** (транспорт), а не IP.
>     
> - **MAC-адреса** — это **канальный** уровень (локальная сеть).
>     
> - **MTU** — максимальный **размер кадра** на канальном уровне (Ethernet обычно 1500).
>     

## Итоги

- Модель TCP/IP делит сеть на 4 логических уровня: Application → Transport → Internet → Link.
- IP-адрес указывает _узел_, порт - _приложение_, MAC - физическую карту внутри одной сети.
- Приложения отправляют данные «вверх», ядро Linux - «распаковывает» их слой за слоем.
- Понимание работы уровней помогает диагностировать проблемы: «где застрял пакет — DNS, порт, маршрут или кабель?»