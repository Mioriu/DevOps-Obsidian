## ![](https://ucarecdn.stepik.net/6dd8063e-1ac5-457b-a6d4-881590303baa/)

## Утилита sed — основы

**sed (stream editor)** — это мощная утилита для работы с текстом в Linux, которая позволяет автоматически выполнять операции поиска и замены, удаления строк и преобразования текста прямо из командной строки.

Основная идея работы sed состоит в обработке текстового потока строка за строкой по заранее заданным правилам.

### Зачем нужна sed?

Утилита sed отлично подходит для автоматизации рутинных операций с текстовыми файлами или вывода команд. Например:

- Быстрая замена текста в большом файле или группе файлов
- Удаление лишних или ненужных строк
- Автоматическое редактирование конфигурационных файлов
- Использование внутри bash-скриптов для динамической обработки данных

### Принцип работы sed

Основной синтаксис команды sed выглядит так:

```1c
sed 'команда' файл
```

Чаще всего вы будете использовать команду замены, которая записывается так:

```1c
sed 's/старый/новый/' файл
```

- `s` — команда замены (substitute)
- `старый` — текст, который нужно заменить
- `новый` — текст, на который будет заменено

Важно: по умолчанию sed не изменяет исходный файл, а только выводит результат в терминал. Если хотите сохранить изменения в файле, используйте опцию `-i`.

### Примеры базового использования sed

#### Пример 1. Простая замена текста

Допустим, есть файл `notes.txt`:

```csharp
Linux is good
Linux is powerful
```

Заменим слово `Linux` на `Ubuntu`:

```nginx
sed 's/Linux/Ubuntu/' notes.txt
```

Результат вывода:

```csharp
Ubuntu is good
Ubuntu is powerful
```

#### Пример 2. Сохранение изменений в файле (-i)

Чтобы сохранить результат прямо в файле:

```nginx
sed -i 's/Linux/Ubuntu/' notes.txt
```

Теперь файл `notes.txt` содержит изменения:

```csharp
Ubuntu is good
Ubuntu is powerful
```

### Замена всех совпадений в строке

По умолчанию sed заменяет только первое совпадение в каждой строке. Если нужно заменить все совпадения, используйте флаг `g` (global):

```nginx
sed 's/Linux/Ubuntu/g' notes.txt
```

### Удаление строк

sed может удалять строки, соответствующие определённому шаблону. Например, удалить строки, содержащие слово `error`:

```nginx
sed '/error/d' logfile.txt
```

- `/error/` — шаблон поиска (регулярное выражение)
- `d` — команда удаления строки

### Работа с диапазонами строк

sed позволяет указывать диапазоны строк, с которыми вы хотите работать.

- Удаление строк с 1 по 3:

```nginx
sed '1,3d' notes.txt
```

- Замена текста только в строке 5:

```nginx
sed '5s/Linux/Ubuntu/' notes.txt
```

- Замена текста от строки 2 до конца файла:

```nginx
sed '2,$s/Linux/Ubuntu/' notes.txt
```

### Использование регулярных выражений в sed

sed очень эффективно работает с регулярными выражениями, которые позволяют искать и заменять текст по шаблону.

- Например, заменить все цифры в файле символом `#`:

```kotlin
sed 's/[0-9]/#/g' data.txt
```

- Удалить пустые строки:

```delphi
sed '/^$/d' file.txt
```

### Обработка вывода других команд

Утилиту sed можно использовать в цепочках с другими командами через конвейер `|`. Например, найти и заменить текст в выводе команды `ps aux`:

```nginx
ps aux | sed 's/root/администратор/g'
```

Эта команда заменит все вхождения слова `root` на слово `администратор` в выводе команды `ps aux`.

### Дополнительные возможности sed

- `-n` — подавить стандартный вывод sed. Обычно используется вместе с командой `p` (print), чтобы вывести только строки, соответствующие шаблону.
- `p` — вывести строку, соответствующую шаблону.

Например, вывести только строки, содержащие слово `Linux`:

```nginx
sed -n '/Linux/p' notes.txt
```

## Краткая шпаргалка по основам sed

- `s/старый/новый/` — замена первого совпадения в строке
- `s/старый/новый/g` — замена всех совпадений в строке
- `-i` — сохранить изменения в файле
- `/pattern/d` — удалить строки, соответствующие шаблону
- `-n '/pattern/p'` — вывести только строки, соответствующие шаблону

## Итог

**sed** — очень мощный и удобный инструмент для автоматизации работы с текстом. Его главные преимущества — простота использования, возможность работы с регулярными выражениями и удобное взаимодействие с другими командами Linux.

В следующем уроке мы потренируемся применять возможности sed на практике, а затем познакомимся с более продвинутыми возможностями этой утилиты.