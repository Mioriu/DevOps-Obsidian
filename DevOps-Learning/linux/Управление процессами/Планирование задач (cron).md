## ![](https://ucarecdn.stepik.net/f9d8f75d-5ab0-4b30-8a50-e3a99630d111/)

Планирование задач — это автоматическое выполнение команд и скриптов в заданное время или через определённые интервалы. В Linux для этого используются встроенные инструменты: **cron**, **at** и таймеры **systemd**. В этом уроке подробно разберём работу с каждым из них.

### ![](https://ucarecdn.stepik.net/210067e1-7530-45b3-882a-5db8b3c96fc7/)

**Cron** позволяет запускать команды и скрипты периодически (ежеминутно, ежедневно, еженедельно и т.д.).

#### Просмотр текущих задач cron

Для просмотра текущих задач выполните команду:

- Для текущего пользователя:
    
    ```nginx
    crontab -l
    ```
    
- Для другого пользователя (root):
    
    ```bash
    sudo crontab -u username -l
    ```
    

#### Редактирование задач cron

Чтобы добавить или изменить задачи:

- Запуск редактора для текущего пользователя:
    
    ```nginx
    crontab -e
    ```
    
- Редактирование cron задач другого пользователя:
    
    ```bash
    sudo crontab -u username -e
    ```
    

#### Формат записи задач cron

Записи в crontab имеют формат:

```1c
* * * * * команда
- - - - -
| | | | |
| | | | +----- день недели (0-7, где 0 и 7 — воскресенье)
| | | +------- месяц (1-12)
| | +--------- число месяца (1-31)
| +----------- час (0-23)
+------------- минута (0-59)
```

Специальные символы:

- `*` — каждый возможный интервал (например, каждая минута, час и т.д.)
- `,` — перечисление (например, 1,15 — в 1 и 15 минут)
- `-` — диапазон (например, 1-5)
- `/` — шаг (например, */10 — каждые 10 минут)

#### Примеры задач cron

- Запуск скрипта ежедневно в 3:00 ночи:
    
    ```bash
    0 3 * * * /home/user/backup.sh
    ```
    
- Запуск команды каждую минуту:
    
    ```lua
    * * * * * /usr/bin/date >> /home/user/time.log
    ```
    
- Запуск еженедельно по воскресеньям в 5 утра:
    
    ```bash
    0 5 * * 0 /home/user/weekly_report.sh
    ```
    

### ![](https://ucarecdn.stepik.net/e4f26123-7b17-48bb-9c6d-784383c7b748/)

Утилита **at** позволяет запускать задачи один раз в указанное время.

#### Установка и использование

Установите `at`, если её нет в системе:

- Debian/Ubuntu:
    
    ```bash
    sudo apt install at
    ```
    
- CentOS/Fedora:
    
    ```bash
    sudo dnf install at
    ```
    

#### Запуск задачи с помощью at

Запустить команду, например, через 10 минут:

```bash
echo "ls -la /tmp" | at now + 10 minutes
```

Или в точное время:

```bash
echo "/home/user/script.sh" | at 16:30
```

#### Просмотр и удаление задач at

- Просмотр списка задач:
    
    ```undefined
    atq
    ```
    
- Удаление задачи по её ID:
- ```nginx
    atrm 2
    ```
    

> at — запускает задачу один раз в будущем. Всегда указывается время, например `at now + 5 minutes` или `at 14:30`. Команда вводится после приглашения at> и завершается Ctrl+D

### ![](https://ucarecdn.stepik.net/d0c48ba2-a9e0-49b7-9c0a-03896041f566/)

Таймеры **systemd** — современный подход к планированию задач. Они интегрируются с сервисами systemd и дают больше контроля и удобства.

#### Создание таймера systemd

Создайте два файла: `mytask.service` и `mytask.timer`.

**Файл сервиса (`/etc/systemd/system/mytask.service`):**

```ini
[Unit]
Description=My scheduled task

[Service]
Type=oneshot
ExecStart=/home/user/script.sh
```

**Файл таймера (`/etc/systemd/system/mytask.timer`):**

```ini
[Unit]
Description=Run mytask every day at 02:00

[Timer]
OnCalendar=*-*-* 02:00:00
Persistent=true

[Install]
WantedBy=timers.target
```

- `OnCalendar` — когда запускать (ежедневно в 02:00).
- `Persistent=true` — запускает пропущенные задачи после перезагрузки.

#### Запуск и управление таймером

- Активируйте таймер:
    
    ```bash
    sudo systemctl enable --now mytask.timer
    ```
    
- Проверка статуса и времени следующего запуска:
    
    ```nginx
    systemctl list-timers
    ```
    
- Просмотр логов выполнения задачи:
    
    ```nginx
    journalctl -u mytask.service
    ```
    

### Когда какой планировщик использовать?

- **cron** — для традиционных, регулярных задач (резервное копирование, отчёты).
- **at** — для выполнения разовых задач в будущем (запуск скриптов, команд в определённый момент).
- **systemd timers** — для современных задач, интегрированных с сервисами systemd (перезапуск сервисов, обновления, сложные сценарии).