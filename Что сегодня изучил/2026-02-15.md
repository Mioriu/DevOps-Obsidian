Сегодня изучал ограничение ресурсов, с помощью cgroup. Это контролируемые группы процессов, которым например заданы ограничения по CPU,RAM и т.д.
Группы находятся по пути /sys/fs/cgroup, там же мы можем например создать свой каталог, со своей группой процессов /sys/fs/cgroup/test_group, так же в этом каталоге находятся файлы, cpu.max, memory.max, cpu.current, memory.current - с текущими ограничениями и текущей нагрузкой, файл cgroup.procs - текущие процессы.
Например установка ограничения процессорного времени
echo "20000 100000" | sudo tee /sys/fs/cgroup/limited_group/cpu.max - ограничение 20%
echo $((500\*1024\*1024)) | sudo tee /sys/fs/cgroup/limited_group/memory.max - ограничение памяти на 500МБ
(
sleep 300 &
echo $! | sudo tee /sys/fs/cgroup/limited_group/cgroup.procs
) -  включение pid группу с ограничением ресурсов
Так же ограничение ресурсов можем отдать на systemd, для этого параметры необходимо прописывать в юните сервиса, например:
[Unit]
Description=My limited service

[Service]
ExecStart=/usr/bin/sleep 300
CPUQuota=20%
MemoryMax=500M

[Install]
WantedBy=multi-user.target
В целом cgroup очень гибкий и важный как в администрировании так и в целом в Linux, инструмент, например на нем базируются контейнерные технологии docker и kubernetes

Познакомился с планировщиками задач, такими как cron(crontab),
например crontab -l - просмотр задач текущего пользователя
crontab -l -u root - просмотр задач другого пользователя
crontab -e - редактирование файла кронов, туда можем записывать задачи для отработки
Пример записи:

\* * * * * команда
- - - - -
| | | | |
| | | | +----- день недели (0-7, где 0 и 7 — воскресенье)
| | | +------- месяц (1-12)
| | +--------- число месяца (1-31)
| +----------- час (0-23)
+------------- минута (0-59)
например:
0 1 \* \* \* ./script.sh - работа скрипта ежедневно в час ночи
\* \* \* \* \*  usr/bin/date >> /home/user/time.log - каждую минуту
утилита at - позволяет запускать процессы в определенное время, например
./script.sh | at now + 5 minutes - запустит процесс через 5 минут 
./script.sh | at 17:00:00 - запустит процесс в определенное время

Так же можно настраивать таймеры через systemd, для этого создаем файл сервиса + файл таймера, в котором прописываем время и зависимость таймера от сервиса:
service.servive и service.timer
sudo systemctl start service && sudo systemctl enable --now service.timer
sudo systemctl list-timers - для просмотра всех таймеров

Еще раз прочитал и вспомнил как важна оценка и анализ производительности системы и мониторинг процессов, основные параметры для мониторинга:
%CPU - нагрузка на процессор - htop,top + сортировка по цпу, ps aux --sort=-%CPU,pidstat
%MEM - количество используемой памяти ps aux --sort=-%mem, smem, free -h
I/O -  дисковый ввод вывод - iostat
Network - нагрузка на сеть - nethogs

perf - утилита для глубокого анализа производительности
Очень важно мониторить данные параметры для исключения перегрузки системы, важно находить проблемные/неоптимизированные места вовремя для исключения перегрузки и отказа системы

Так же читал про системы управления загрузкой, GRUB, initramfs, тут нужно будет почитать поглубже т.к. пока не разобрался в назначении, понял только что initramfs необходим для создания файловой системы, а GRUB отвечает за запуск операционной системы после включения пк (/etc/default/grub)

systemd - система инициализации и управления сервисами. Служит для запуска, настройки, перезагрузки, просмотра журнала сервисов.
Настраивается с помощью специальных Unit файлов расположенных в /etc/systemd/system/*
Может автоматически запускать сервисы при загрузке операционной системы, перезапускать в случае ошибок и остановки сервисов, мониторить логи отработки, запускать сервисы после определенных событий, например после запуска сети(network.target), и т.д
Управляется через команды
systemctl, journalctl - для просмотра логов

!Важно после изменения юнит файлов обязательно перезапускать демон systemd
sudo systemctl daemon-reload, для применения новых параметров


[[Ограничение ресурсов (cgroups)]] [[Анализ производительности процессов]] [[Планирование задач (cron)]] [[Управление загрузкой (GRUB,initramfs)]] [[Systemd и управление сервисами]] 
